#' Import NHD data for park
#' 
#' This function uses the nhdplusTools package to import flowline, catchments and
#' water body spatial data for parks, within a specified buffer distance around
#' the park boundary
#' 
#' @param park The 4-digit unit code(s) for national parks of interest. Must be in ALL CAPS.
#' @param dist The buffer distance (in decimal degrees) around park boundaries to filter NHD data to
#' @param save Whether to save (TRUE) the resulting shapefile or not (FALSE)
#' @param path If `save == TRUE`, the file path to save the shapefile. Must end with "/"
#' 
#' @return A list of spatial sf objects, one for flowlines, cactchments and water bodies
#' 
#' @seealso [getParkBoundary()]
getNHD <- function(park, dist, save = FALSE, path){
  
  sf_use_s2(FALSE)
  
  aoi <- getParkBoundary(park) %>% 
    sf::st_buffer(dist) %>% 
    dplyr::summarise()

  nhd_flowlines <- nhdplusTools::get_nhdplus(AOI = aoi, 
                             realization='flowline')

  nhd_catchments <- nhdplusTools::get_nhdplus(AOI=aoi, 
                              realization='catchment')

  nhd_waterbodies <- nhdplusTools::get_waterbodies(AOI=aoi)
  
  obj <- list(nhd_flowlines, nhd_catchments, nhd_waterbodies)
  
  names(obj) <- c("flowlines", "catchments", "waterbodies")
  
  return(obj)
  
}