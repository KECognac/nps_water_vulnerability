#' Download data from NPS Data Store
#' 
#' This function uses the Data Store REST Api to download data for Nation Parks,
#' using the resource IDs retrieved from `pullDataStore()`
#' 
#' @param resourceID The resourceID retrieved for a specific entry from `pullDataStore()`
#' @param path The file path to save the file to. Path MUST end with '/'
#' 
#' @return Data file saved to specified folder
#' 
#' @seealso [pullDataStore()]
downloadDataStore <- function(resourceID, path){
  
  call <- "https://irmaservices.nps.gov/datastore/v4/rest"
  
  
  for(i in 1:length(resourceID)){
    
    #content types = 'application/x-zip-compressed', 'application/pdf', 'image/jpeg', '"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", 'text/xml
    
    dat <- httr::GET(paste0(call, "/DownloadFile/", resourceID[i]))
    
    type <- dat$headers$`content-type`
    
    if(stringr::str_detect(type, "pdf")){
     
      download.file(paste0(call, "/DownloadFile/", resourceID[i]), destfile = paste(path, resourceID[i], ".pdf"), method = "curl")

    } else if(stringr::str_detect(type, "jpeg")){
      
      download.file(paste0(call, "/DownloadFile/", resourceID[i]), destfile = paste(path, resourceID[i], ".jpg"), method = "curl")
      
    } else if(stringr::str_detect(type, "xml")){
      
      download.file(paste0(call, "/DownloadFile/", resourceID[i]), destfile = paste(path, resourceID[i], ".xml"), method = "curl")
      
    } else if(stringr::str_detect(type, "sheet")){
      
      download.file(paste0(call, "/DownloadFile/", resourceID[i]), destfile = paste(path, resourceID[i], ".xlsx"), method = "curl")
      
    } else if(stringr::str_detect(type, "zip")){
    
    download.file(paste0(call, "/DownloadFile/", resourceID[i]), destfile = paste(path, resourceID[i], ".zip"), method = "curl")

    }
    
    print(resourceID)
    
  }
  
    
  
}