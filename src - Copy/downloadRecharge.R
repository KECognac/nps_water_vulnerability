#' Import groundwater recharge raster
#' 
#'
#' 
#' @param aoi An sf polygon object, often a park boundary (or boundaries) retrieved from `getParkBoundary()`.
#' @param dist The buffer distance (in decimal degrees) around park boundaries to filter data to
#' @param save Whether to save (TRUE) the resulting shapefile or not (FALSE)
#' @param path If `save = TRUE`, the file path to save the shapefile
#' 
#' @return A sGW recharge raster each specified park boundary
#' 
#' @seealso [getParkBoundary()]
downloadRecharge <- function(aoi, dist, save=FALSE, path){
  
  if(!dir.exists(paste0(getwd(),"/data/all/"))){dir.create(file.path(getwd(),"data/all/"), showWarnings = FALSE)}
  
  call <- "https://water.usgs.gov/GIS/dsdl/rech48grd.zip"
  
  #download boundary 
  temp1 <- tempfile()
  download.file(paste0(call), destfile = temp1, method = "curl")
  unzip(temp1, exdir = "data/all/")
  
  sf::sf_use_s2(FALSE)
  
  aoi <- aoi %>% 
    sf::st_buffer(dist = dist)
  
  gw_recharge <- list()
  
  
  for(i in 1:nrow(aoi)){
  gw_recharge[[i]] <- raster::raster("data/all/rech48grd") %>%
    raster::projectRaster(crs=4269) %>%
    raster::mask(aoi[i,])%>%
    raster::crop(aoi[i,])
  }
    
  if(save == TRUE){
    if(save == TRUE){

      
      
      
    }
    
    
  }
  
  return(gw_recharge)
}
