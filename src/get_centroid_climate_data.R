get_centroid_climate_data <- function(park,
                                      save = FALSE,
                                      path = "data/park") {
  call <-
    "https://parkfutures.s3.us-west-2.amazonaws.com/maca-tprh-data/0Climate_Zones_by_Unit_cleaned.csv"
  
  if (save == FALSE) {
    if (!dir.exists("temp_data/")) {
      dir.create("temp_data")
    }
    
    if (!dir.exists("temp_data/files")) {
      dir.create("temp_data/files")
    }
    
    download.file(paste0(call), destfile = "temp_data/park_list.csv")
    
    park_koppen <-
      read_csv("temp_data/park_list.csv", skip = 1) %>%
      filter(UNIT_CODE == park) %>%
      .$Unit_ClimateZone %>%
      c(park) %>%
      as_tibble() %>%
      tidyr::crossing(., tibble(period = c("_historical", "_future"))) %>%
      mutate(name = paste0(value, period)) %>%
      .$name
    
    downloader <- function(park_koppens) {
      centroids <-
        paste0(
          "https://parkfutures.s3.us-west-2.amazonaws.com/maca-tprh-data/",
          park_koppens,
          ".csv"
        )
      download.file(paste0(centroids),
                    destfile = paste0("temp_data/files/", park_koppens, ".csv"))
    }
    
    park_koppen %>%
      walk( ~ downloader(.))
    
    # read files into environment

    
    walk(list.files("temp_data/files", full.names = TRUE, recursive = TRUE), function(x) {
                     tmp <- read_csv(x)
                     # hacky way to pull filename to assign to env object
                     name <-  str_sub(x, 17, -5)
                     assign(name, tmp, envir = .GlobalEnv)
                   })
    
    unlink("temp_data/", recursive = TRUE)
    
  } else {
    if (!dir.exists(paste0(getwd(), "/templeod_dataall/"))) {
      dir.create(file.path(getwd(), "/templeod_dataall/"), showWarnings = FALSE)
    }
    
    if (!dir.exists(paste0(getwd(), "/", path, "/", park))) {
      dir.create(file.path(paste0(getwd(), "/", path, "/", park)), showWarnings = FALSE)
    }
    
    if (!dir.exists(paste0(getwd(), "/", path, "/", park, "/centroid/"))) {
      dir.create(file.path(paste0(
        getwd(), "/", path, "/", park, "/centroid/"
      )), showWarnings = FALSE)
    }
    
    if (!dir.exists(paste0(getwd(), "/", path, "/", park, "/centroid/climate/"))) {
      dir.create(file.path(
        paste0(getwd(), "/", path, "/", park, "/centroid/climate/")
      ), showWarnings = FALSE)
    }
    
    download.file(paste0(call), destfile = "templeod_dataall/park_list.csv")
    
    park_koppen <-
      read_csv("templeod_dataall/park_list.csv", skip = 1) %>%
      filter(UNIT_CODE == park) %>%
      .$Unit_ClimateZone %>%
      c(park) %>%
      as_tibble() %>%
      tidyr::crossing(., tibble(period = c("_historical", "_future"))) %>%
      mutate(name = paste0(value, period)) %>%
      .$name
    
    downloader <- function(park_koppens) {
      centroids <-
        paste0(
          "https://parkfutures.s3.us-west-2.amazonaws.com/maca-tprh-data/",
          park_koppens,
          ".csv"
        )
      download.file(
        paste0(centroids),
        destfile = paste0(
          path,
          "/",
          park,
          "/centroid/climate/",
          park_koppens,
          ".csv"
        )
      )
    }
    
    park_koppen %>%
      walk(~ downloader(.))
    
    unlink("templeod_dataall", recursive = TRUE)
  }
  
}
